---
title: "Pianoâ€‘roll Diffusion"
collection: publications
---

<h2>Generation</h2>

<style>
    /* Custom player style */
    midi-player {
        display: block;
        width: inherit;
        margin: 4px;
        margin-bottom: 0;
    }

    midi-player::part(control-panel) {
        background: #252a34;
        border: 2px solid #000;
        border-radius: 10px 10px 0 0;
    }

    midi-player::part(play-button) {
        color: #353;
        border: 2px solid currentColor;
        background-color: #4d4;
        border-radius: 20px;
        transition: all 0.2s;
        content: 'hello';
    }

    midi-player::part(play-button):hover {
        color: #0a0;
        background-color: #5f5;
        border-radius: 10px;
    }

    midi-player::part(time) {
        font-family: monospace;
    }

    /* Custom visualizer style */
    midi-visualizer .piano-roll-visualizer {
        background: #252a34;
        border: 2px solid black;
        border-top: none;
        border-radius: 0 0 10px 10px;
        margin: 4px;
        margin-top: 0;
        overflow: auto;
    }

    midi-visualizer svg rect.note {
        opacity: 0.6;
        stroke-width: 2;
    }

    midi-visualizer svg rect.note[data-instrument="0"] {
        fill: #e22;
        /* stroke: #500; */
    }

    midi-visualizer svg rect.note[data-instrument="1"] {
        fill: #2ee;
        /* stroke: #055; */
    }

    midi-visualizer svg rect.note[data-is-drum="true"] {
        fill: #888;
        /* stroke: #888; */
    }

    midi-visualizer svg rect.note.active {
        opacity: 0.9;
        stroke: #000;
    }
</style>

<section id="section3">
    <midi-player src="/media/uncond_pop909_0.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
    <midi-player src="/media/uncond_pop909_1.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
    <midi-player src="/media/uncond_pop909_2.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
    <midi-player src="/media/uncond_pop909_3.mid" sound-font visualizer="#Vis_uncond"> </midi-player>

    <midi-visualizer type="piano-roll" id="Vis_uncond"> </midi-visualizer>
</section>

<h2>Internal Control (Inpainting)</h2>

<h3>Inpaint accompaniment given melody</h3>

The sampling length is 8 bars (16s). If the MIDI is longer than 8 bars, each 8-bar segment is seperately sampled.

Melody:
<midi-player src="/media/uncond_inp_below_canon_mld.mid" sound-font visualizer="#Vis_inp_below_mld"> </midi-player>
<midi-visualizer src="/media/uncond_inp_below_canon_mld.mid" type="piano-roll" id="Vis_inp_below_mld">
</midi-visualizer>

Inpainted results:

<midi-player src="/media/uncond_inp_below_canon_0_split.mid" sound-font visualizer="#Vis_inp_below"> </midi-player>
<midi-player src="/media/uncond_inp_below_canon_1_split.mid" sound-font visualizer="#Vis_inp_below"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_inp_below"> </midi-visualizer>

Melody:
<midi-player src="/media/uncond_inp_below_ode_mld.mid" sound-font visualizer="#Vis_inp_below_mld_1"> </midi-player>
<midi-visualizer src="/media/uncond_inp_below_ode_mld.mid" type="piano-roll" id="Vis_inp_below_mld_1">
</midi-visualizer>

Inpainted results:
<midi-player src="/media/uncond_inp_below_ode_0_split.mid" sound-font visualizer="#Vis_inp_below_1"> </midi-player>
<midi-player src="/media/uncond_inp_below_ode_1_split.mid" sound-font visualizer="#Vis_inp_below_1"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_inp_below_1"> </midi-visualizer>

<h3>Inpaint melody given accompaniment</h3>

Accompaniment:
<midi-player src="/media/uncond_inp_above_acc.mid" sound-font visualizer="#Vis_inp_above_acc"> </midi-player>
<midi-visualizer src="/media/uncond_inp_above_acc.mid" type="piano-roll" id="Vis_inp_above_acc"> </midi-visualizer>

Inpainted results:

<midi-player src="/media/uncond_inp_above_0_split.mid" sound-font visualizer="#Vis_inp_above"> </midi-player>
<midi-player src="/media/uncond_inp_above_1_split.mid" sound-font visualizer="#Vis_inp_above"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_inp_above"> </midi-visualizer>

<h3>Inpaint bars within a 8-bar segment</h3>

Original segment:

<midi-player src="/media/uncond_inp_bars_orig.mid" sound-font visualizer="#Vis_inp_bars_orig"> </midi-player>
<midi-visualizer src="/media/uncond_inp_bars_orig.mid" type="piano-roll" id="Vis_inp_bars_orig"> </midi-visualizer>

Inpainted results:
<midi-player src="/media/uncond_inp_bars_0.mid" sound-font visualizer="#Vis_inp_bars"> </midi-player>
<midi-player src="/media/uncond_inp_bars_1.mid" sound-font visualizer="#Vis_inp_bars"> </midi-player>
<midi-player src="/media/uncond_inp_bars_2.mid" sound-font visualizer="#Vis_inp_bars"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_inp_bars"> </midi-visualizer>

<h3>Autoregressive Inpainting</h3>

<midi-player src="/media/uncond_autoreg_0.mid" sound-font visualizer="#Vis_inp_autoreg"> </midi-player>
<midi-visualizer src="/media/uncond_autoreg_0.mid" type="piano-roll" id="Vis_inp_autoreg"> </midi-visualizer>

<h2>External Control (Conditional Generation)</h2>

<h3>Conditioned on chord progression</h3>

Given chord progression:
<midi-player src="/media/chd_v_chd.mid" sound-font visualizer="#Vis_chd_v_chd"> </midi-player>
<midi-visualizer src="/media/chd_v_chd.mid" type="piano-roll" id="Vis_chd_v_chd"> </midi-visualizer>

Generation (different random seeds):
<midi-player src="/media/chd_v_0.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>
<midi-player src="/media/chd_v_1.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>
<midi-player src="/media/chd_v_2.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_chd_v"> </midi-visualizer>

Given chd progression:
<midi-player src="/media/chd_gs_chd.mid" sound-font visualizer="#Vis_chd_gs_chd"> </midi-player>
<midi-visualizer src="/media/chd_gs_chd.mid" type="piano-roll" id="Vis_chd_gs_chd"> </midi-visualizer>

Generation (same seed with different guidance scales):
<br>
guidance scale = 1
<midi-player src="/media/chd_gs_1.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player>
guidance scale = 3
<midi-player src="/media/chd_gs_3.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player>
guidance scale = 5
<midi-player src="/media/chd_gs_5.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player>
guidance scale = 10
<midi-player src="/media/chd_gs_10.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_chd_gs"> </midi-visualizer>

<h3>Conditioned on texture</h3>

Given texture from MIDI:
<midi-player src="/media/txt_v_txt.mid" sound-font visualizer="#Vis_txt_v_txt"> </midi-player>
<midi-visualizer src="/media/txt_v_txt.mid" type="piano-roll" id="Vis_txt_v_txt"> </midi-visualizer>

Generation (different random seeds):
<midi-player src="/media/txt_v_0.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<midi-player src="/media/txt_v_1.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<midi-player src="/media/txt_v_2.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_txt_v"> </midi-visualizer>

Given texture from MIDI:
<midi-player src="/media/txt_gs_txt.mid" sound-font visualizer="#Vis_txt_gs_txt"> </midi-player>
<midi-visualizer src="/media/txt_gs_txt.mid" type="piano-roll" id="Vis_txt_gs_txt"> </midi-visualizer>

Generation (same seed with different guidance scales):
<br>
guidance scale = 1
<midi-player src="/media/txt_gs_1.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player>
guidance scale = 3
<midi-player src="/media/txt_gs_3.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player>
guidance scale = 5
<midi-player src="/media/txt_gs_5.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player>
guidance scale = 10
<midi-player src="/media/txt_gs_10.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_txt_gs"> </midi-visualizer>


<h2>Internal & External Control</h2>

<h3>Inpaint accompaniment given melody, conditioned on chord progression</h3>

Melody:
<midi-player src="/media/uncond_inp_below_canon_mld.mid" sound-font visualizer="#Vis_chd_inp_below_mld"> </midi-player>
<midi-visualizer src="/media/uncond_inp_below_canon_mld.mid" type="piano-roll" id="Vis_chd_inp_below_mld">
</midi-visualizer>

Chord progression (condition):
<midi-player src="/media/chd_v_chd.mid" sound-font visualizer="#Vis_chd_inp_below_chd"> </midi-player>
<midi-visualizer src="/media/chd_v_chd.mid" type="piano-roll" id="Vis_chd_inp_below_chd"> </midi-visualizer>

Inpainted results:

<midi-player src="/media/chd_inp_below_canon_0_split.mid" sound-font visualizer="#Vis_chd_inp_below"> </midi-player>
<midi-player src="/media/chd_inp_below_canon_1_split.mid" sound-font visualizer="#Vis_chd_inp_below"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_chd_inp_below"> </midi-visualizer>

<h3>Inpaint melody given accompaniment, conditioned on texture</h3>

Accompaniment:
<midi-player src="/media/txt_inp_above_acc.mid" sound-font visualizer="#Vis_txt_inp_above_acc"> </midi-player>
<midi-visualizer src="/media/txt_inp_above_acc.mid" type="piano-roll" id="Vis_txt_inp_above_acc">
</midi-visualizer>

Texture MIDI (condition):
<midi-player src="/media/txt_inp_above_txt.mid" sound-font visualizer="#Vis_txt_inp_above_txt"> </midi-player>
<midi-visualizer src="/media/txt_inp_above_txt.mid" type="piano-roll" id="Vis_txt_inp_above_txt"> </midi-visualizer>

Inpainted results:

<midi-player src="/media/txt_inp_above_0.mid" sound-font visualizer="#Vis_txt_inp_above"> </midi-player>
<midi-player src="/media/txt_inp_above_1.mid" sound-font visualizer="#Vis_txt_inp_above"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_txt_inp_above"> </midi-visualizer>


<script
    src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0"></script>
